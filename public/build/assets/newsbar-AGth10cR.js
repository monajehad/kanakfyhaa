class s{constructor(t={}){if(this.container=document.querySelector(t.container??"#newsBar"),this.track=document.querySelector(t.track??"#newsTrack"),this.speed=t.speed??100,this.startDelay=t.startDelay??1e3,this.direction=t.direction??"rtl",this.pauseOnHover=t.pauseOnHover??!0,this.theme=t.theme??"light",this.sound=t.sound??!1,this.animation=t.animation??"scroll",this.itemSpace=t.itemSpace!==void 0?Number(t.itemSpace):0,this.position=0,this.paused=!1,this.width=0,this.animationFrame=null,this.events={},this.startTime=0,this.offsetWhenResized=0,!this.container||!this.track){console.error("NewsBar: container or track not found");return}window.addEventListener("load",()=>{this.setup(),setTimeout(()=>this.start(),this.startDelay)}),window.addEventListener("resize",()=>this.handleResize()),this.pauseOnHover&&(this.container.addEventListener("mouseenter",()=>this.pause()),this.container.addEventListener("mouseleave",()=>this.resume())),document.hidden!==void 0&&document.addEventListener("visibilitychange",()=>{document.hidden?this.pause():this.resume()})}setup(){cancelAnimationFrame(this.animationFrame);const t=[...this.track.querySelectorAll("[data-original]")];t.length===0?[...this.track.children].forEach(i=>i.setAttribute("data-original","true")):(this.track.innerHTML="",t.forEach(i=>this.track.appendChild(i.cloneNode(!0))));const e=this.track.innerHTML;this.track.innerHTML=e+e,this.width=this.track.scrollWidth/2,this.track.style.transform=`translateX(${this.position}px)`,document.documentElement.setAttribute("data-theme",this.theme)}start(){this.emit("start"),this.startTime=performance.now()-this._timeElapsedForCurrentPosition(),this.animate()}animate(){if(this.paused)return;const e=(performance.now()-this.startTime)/1e3,i=this.direction==="rtl"?-1:1;this.position=e*this.speed*i%this.width,this.position<-this.width&&(this.position+=this.width),this.position>this.width&&(this.position-=this.width),this.track.style.transform=`translateX(${this.position}px)`,this.animationFrame=requestAnimationFrame(()=>this.animate())}pause(){this.paused||(this.paused=!0,cancelAnimationFrame(this.animationFrame),this.container.classList.add("paused"),this.emit("pause"))}resume(){this.paused&&(this.paused=!1,this.startTime=performance.now()-this._timeElapsedForCurrentPosition(),this.container.classList.remove("paused"),this.animate(),this.emit("resume"))}setSpeed(t){this.speed=t}setDirection(t){["rtl","ltr"].includes(t)&&(this.direction=t)}setTheme(t){this.theme=t,document.documentElement.setAttribute("data-theme",t)}setItemSpace(t){this.itemSpace=t!==void 0?Number(t):0,this.setup()}setItems(t){this.track.innerHTML=t.map(e=>`<span style="display:inline-block;${this.itemSpace?"margin-inline-end:"+this.itemSpace+"px;":""}white-space:pre;">${e}</span>`).join(""),this.setup()}loadFrom(t){fetch(t).then(e=>e.json()).then(e=>{e.items&&(this.setItems(e.items),this.sound&&new Audio("/assets/media/tick.mp3").play())})}on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}emit(t,e){this.events[t]&&this.events[t].forEach(i=>i(e))}handleResize(){const t=this._timeElapsedForCurrentPosition();this.setup(),this.startTime=performance.now()-t}_timeElapsedForCurrentPosition(){if(!this.width)return 0;const t=this.direction==="rtl"?-1:1;let e=this.position/(this.speed*t);return e<0&&(e+=this.width/Math.abs(this.speed)),e*1e3}}window.NewsBar=s;
